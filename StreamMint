git remote add origin https://github.com/Nico81018/StreamMint.git
 git branch -M main 
git push -u origin main

#!/usr/bin/env bash
set -e

GIT_REMOTE_URL="https://github.com/Nico81018/StreamMint.git"
BRANCH=${1:-main}

echo "[1/4] Inizializzo repository Git localeâ€¦"
if [ ! -d .git ]; then
  git init
  git checkout -b $BRANCH
fi

echo "[2/4] Aggiungo file e creo commitâ€¦"
git add -A
if ! git rev-parse --verify HEAD >/dev/null 2>&1; then
  git commit -m "Initial import: StreamMint (full app + infra)"
else
  git commit -m "Update: StreamMint" || echo "Nessuna modifica"
fi

echo "[3/4] Imposto remote originâ€¦"
git remote remove origin 2>/dev/null || true
git remote add origin "$GIT_REMOTE_URL"

echo "[4/4] Push sul repository GitHubâ€¦"
git push -u origin $BRANCH --force

echo "ðŸŽ‰ Push completato! Repo: $GIT_REMOTE_URL (branch: $BRANCH)"

#!/usr/bin/env bash
set -e

REPO="Nico81018/StreamMint"

echo "Inserisci SPOTIFY_CLIENT_ID:"
read SPOTIFY_CLIENT_ID
echo "Inserisci SPOTIFY_CLIENT_SECRET:"
read SPOTIFY_CLIENT_SECRET

echo "Inserisci GOOGLE_CLIENT_ID:"
read GOOGLE_CLIENT_ID
echo "Inserisci GOOGLE_CLIENT_SECRET:"
read GOOGLE_CLIENT_SECRET

echo "Inserisci TANGO_API_KEY:"
read TANGO_API_KEY
echo "Inserisci TANGO_SENDER_ID:"
read TANGO_SENDER_ID
echo "Inserisci TANGO_WEBHOOK_SECRET:"
read TANGO_WEBHOOK_SECRET

echo "Inserisci DATABASE_URL:"
read DATABASE_URL
echo "Inserisci REDIS_URL:"
read REDIS_URL

SESSION_KEY=$(openssl rand -hex 32)

echo "Imposto secrets su GitHubâ€¦"

gh secret set SPOTIFY_CLIENT_ID --repo $REPO --body "$SPOTIFY_CLIENT_ID"
gh secret set SPOTIFY_CLIENT_SECRET --repo $REPO --body "$SPOTIFY_CLIENT_SECRET"
gh secret set GOOGLE_CLIENT_ID --repo $REPO --body "$GOOGLE_CLIENT_ID"
gh secret set GOOGLE_CLIENT_SECRET --repo $REPO --body "$GOOGLE_CLIENT_SECRET"
gh secret set TANGO_API_KEY --repo $REPO --body "$TANGO_API_KEY"
gh secret set TANGO_SENDER_ID --repo $REPO --body "$TANGO_SENDER_ID"
gh secret set TANGO_WEBHOOK_SECRET --repo $REPO --body "$TANGO_WEBHOOK_SECRET"
gh secret set DATABASE_URL --repo $REPO --body "$DATABASE_URL"
gh secret set REDIS_URL --repo $REPO --body "$REDIS_URL"
gh secret set SESSION_KEY --repo $REPO --body "$SESSION_KEY"

echo "ðŸŽ‰ Secrets configurati correttamente!"

#!/usr/bin/env bash
set -e

echo "ðŸš€ StreamMint â€” Setup Infrastruttura Locale"

echo "[1/5] Avvio Docker Composeâ€¦"
docker compose up -d

echo "[2/5] Attesa Postgresâ€¦"
until docker exec $(docker ps -qf "name=postgres") pg_isready -U postgres >/dev/null 2>&1; do
  echo "Attesa che Postgres sia prontoâ€¦"
  sleep 2
done

echo "[3/5] Eseguo migrazione SQL inizialeâ€¦"
docker exec -i $(docker ps -qf "name=postgres") psql -U postgres -d streammint < backend/sql/migrations/001_init.sql

echo "[4/5] Verifica stato serviziâ€¦"
curl -s http://localhost:4000/health || echo "Backend non ancora pronto"

echo "[5/5] Completato!"
echo "ðŸŽ‰ Infrastruttura pronta: http://localhost:5173"

./setup_infra.sh

"dependencies": {
  "otplib": "^12.0.1",
  "qrcode": "^1.5.1",
  "ioredis": "^5.0.0",
  "pg": "^8.0.0",
  "bcryptjs": "^2.4.3",
  "jsonwebtoken": "^9.0.0"
}

psql "${DATABASE_URL}" -f backend/sql/migrations/001_init.sql
node backend/src/seed_admin.js

cd /percorso/del/tuo/progetto/StreamMint

# 1) crea branch per i cambiamenti
git checkout -b feature/admin-2fa-logging-seed

# 2) copia/estrai i file del pacchetto (se ancora non lo hai fatto)
# Assumendo che lo zip sia nella stessa macchina, decomprimi nella root:
unzip /path/to/streammint_full_update_v2.zip -d .

# 3) aggiungi i nuovi file e fai commit
git add -A
git commit -m "Feat: admin dashboard, 2FA, rate-limiter, seeder, logging + assets"

# 4) push del branch
git push -u origin feature/admin-2fa-logging-seed

# 5) apri PR (richiede gh CLI)
gh pr create --title "Admin: 2FA, rate-limit, admin API, assets" --body "Aggiunta admin, 2FA TOTP, rate-limiter Redis, seeder, logo e documentazione." --base main

git diff --staged > streammint_changes.patch
# inviami il contenuto o applicalo su un altro clone con:
git apply streammint_changes.patch

REPO="Nico81018/StreamMint"

gh secret set SPOTIFY_CLIENT_ID --repo $REPO --body "your_spotify_client_id"
gh secret set SPOTIFY_CLIENT_SECRET --repo $REPO --body "your_spotify_client_secret"
gh secret set GOOGLE_CLIENT_ID --repo $REPO --body "your_google_client_id"
gh secret set GOOGLE_CLIENT_SECRET --repo $REPO --body "your_google_client_secret"
gh secret set TANGO_API_KEY --repo $REPO --body "your_tango_api_key"
gh secret set TANGO_SENDER_ID --repo $REPO --body "your_tango_sender_id"
gh secret set TANGO_WEBHOOK_SECRET --repo $REPO --body "your_tango_webhook_secret"
gh secret set DATABASE_URL --repo $REPO --body "postgres://postgres:password@host:5432/streammint"
gh secret set REDIS_URL --repo $REPO --body "redis://:password@host:6379"
gh secret set SESSION_KEY --repo $REPO --body "$(openssl rand -hex 32)"

# backend
cd backend
# aggiungi le dipendenze raccomandate
npm install otplib qrcode ioredis pg bcryptjs jsonwebtoken axios
# (se mancano nodemon per sviluppo)
npm install --save-dev nodemon

"scripts": {
  "start": "node src/index.js",
  "dev": "nodemon src/index.js",
  "seed": "node src/seed_admin.js",
  "test": "node src/tests/antifraud.test.js"
}

cd ../frontend
npm install
# per Vite dev:
npm run dev
docker compose up -d --build

export DATABASE_URL="postgres://postgres:password@localhost:5432/streammint"
psql "${DATABASE_URL}" -f backend/sql/migrations/001_init.sql

# assicurati DATABASE_URL impostato
cd backend
npm run seed
# output: "Seed complete"

# health check backend
curl http://localhost:4000/health
# test admin login (example)
curl -X POST http://localhost:4000/admin/login -H "Content-Type: application/json" -d '{"email":"admin@example.com","password":"admin123"}'
# should return { "token": "..." }

cd backend
npm install winston express-winston

// backend/src/logger.js
const winston = require('winston');

const logger = winston.createLogger({
  level: process.env.LOG_LEVEL || 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.json()
  ),
  transports: [
    new winston.transports.Console()
    // in prod: add file or remote transport (Datadog/LogDNA)
  ],
});

module.exports = logger;

const logger = require('./logger');
logger.info('Starting backend', { env: process.env.NODE_ENV });

npm install @sendgrid/mail

// backend/src/services/email.js
const sgMail = require('@sendgrid/mail');
sgMail.setApiKey(process.env.SENDGRID_API_KEY);

async function sendRewardFulfilled(toEmail, subject, plainText, html){
  const msg = {
    to: toEmail,
    from: process.env.EMAIL_FROM || 'no-reply@streammint.io',
    subject,
    text: plainText,
    html
  };
  return sgMail.send(msg);
}

module.exports = { sendRewardFulfilled };

const { sendRewardFulfilled } = require('./services/email');
// ...
await sendRewardFulfilled(recipient_email, 'Il tuo voucher Ã¨ arrivato', '... testo ...', '<b>...</b>');

